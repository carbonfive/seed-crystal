#!/bin/sh

# All-in-one workstation zero configuration setup

/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

brew update
brew bundle --file=- <<EOT
<%= view_data.brewfile %>
EOT

createuser -s postgres

<% view_data.vsc_extensions.each do |ext| %>
<%= "/Applications/Visual\\ Studio\\ Code.app/Contents/Resources/app/bin/code --install-extension #{ext}" %>
<% end %>

open /Applications/KeepingYouAwake.app
open /Applications/Divvy.app
open /Applications/Flycut.app
open /Applications/Muzzle.app

echo "Adding /usr/local/bin/zsh to /etc/shells"
grep -q /usr/local/bin/zsh /etc/shells || sudo sh -c "echo /usr/local/bin/zsh >> /etc/shells"

sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
sed -i '' 's/plugins=.*/plugins=(brew git rbenv gem rake bundler node npm heroku postgres redis-cli)/' ~/.zshrc
